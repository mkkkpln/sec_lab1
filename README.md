# –õ–†-1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ REST API —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π CI/CD

---

### –í—ã–ø–æ–ª–Ω–∏–ª–∞:
- **–°—Ç—É–¥–µ–Ω—Ç–∫–∞:** –ö–æ–ø–∞–ª–∏–Ω–∞ –ú–∞–π—è –ê–ª–µ–∫—Å–µ–µ–≤–Ω–∞  
- **–ì—Ä—É–ø–ø–∞:** P3432  
- **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:** Java / Spring Boot  

---

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ API

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —Å –¥–≤—É–º—è —Å—É—â–Ω–æ—Å—Ç—è–º–∏:

- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (User)** ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ, –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ—Å—Ç—ã.  
- **–ü–æ—Å—Ç (Post)** ‚Äî –∫–æ–Ω—Ç–µ–Ω—Ç, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.  

–°–≤—è–∑—å: **–æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –º–Ω–æ–≥–æ –ø–æ—Å—Ç–æ–≤**.

–î–∞–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ —Å–≤—è–∑–∞–Ω—ã –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –û–¥–∏–Ω-–∫–æ-–ú–Ω–æ–≥–∏–º:

- –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å 0 –∏–ª–∏ –±–æ–ª–µ–µ –ø–æ—Å—Ç–æ–≤;
- –£ –ø–æ—Å—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Ç.–Ω. –∞–≤—Ç–æ—Ä).

---

## üîë –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã API

### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**POST** `/api/auth/sign-up`  
–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "email": "test@test.com",
  "password": "123456",
  "nickname": "tester"
}
```
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (201 Created):
```json
{
  "token": "eyJhbGciOiJIUzI1NiJ9..."
}
```
### 2. –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**POST** /api/auth/sign-in
–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "email": "test@test.com",
  "password": "123456"
}
```
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
{
  "token": "eyJhbGciOiJIUzI1NiJ9..."
}
```
### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
**GET** /api/users
–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: Bearer <JWT>

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
[
  {
    "email": "test@test.com",
    "nickname": "tester"
  }
]
```
### 4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
**POST** /api/posts
–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: Bearer <JWT>

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "title": "–ú–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç",
  "content": "–≠—Ç–æ—Ç –ø–æ—Å—Ç —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ API!"
}
```
–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (201 Created):
```json
{
  "id": 1,
  "title": "–ú–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç",
  "content": "–≠—Ç–æ—Ç –ø–æ—Å—Ç —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ API!"
}
```
### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**GET** /api/posts
–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: Bearer <JWT>

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
[
  {
    "id": 1,
    "title": "–ú–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç",
    "content": "–≠—Ç–æ—Ç –ø–æ—Å—Ç —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ API!"
  }
]
```

### –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ä –∑–∞—â–∏—Ç—ã

#### –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection:

–î–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞ spring-boot-starter-data-jpa:3.5.5 –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ –¥–∞–Ω–Ω—ã–π 
—Å—Ç–∞—Ä—Ç–µ—Ä ORM Hibernate 6.6.26.Final
  - query-–º–µ—Ç–æ–¥—ã:
    ```java
    @Repository
    public interface UserRepository extends JpaRepository<User, Long> {
    
        User findByEmail(String email);
    
    }
    ```
  - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥ save:
    ```java
    @Transactional
    public PostDto createPost(PostDto postDto) {
        String email = ((User) SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getEmail();
        User user = userRepository.findByEmail(email);

        Post post = Post.builder()
                .content(postDto.getContent())
                .user(user)
                .build();

        postRepository.save(post);
        return postDto;
    }
    ```

–ó–∞ —Å—á–µ—Ç —Ç–æ–≥–æ, —á—Ç–æ "–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º" –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è Prepared Statements, –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞—â–∏—â–µ–Ω–æ –æ—Ç SQL Injection.

#### –ó–∞—â–∏—Ç–∞ –æ—Ç XSS:

–î–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç XSS –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å—Ç–∞—Ä—Ç–µ—Ä–∞ spring-boot-starter-security:3.5.5:
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OWASP Java HTML —Å–∞–Ω–∏—Ç–∞–π–∑–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É –≤–∏–¥—É
(–∑–∞–º–µ–Ω—è–µ—Ç —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã, —É–¥–∞–ª—è–µ—Ç —Ç–µ–≥–∏ –∏ —Ç.–¥.):
    ```java
    private static final PolicyFactory POLICY = Sanitizers.FORMATTING.and(Sanitizers.LINKS);

    private String sanitize(String input) {
        return POLICY.sanitize(input);
    }
    ```
  - –î–ª—è –±–æ–ª—å—à–µ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –±—ã–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (Content-Security-Policy; CSP), –∫–æ—Ç–æ—Ä—ã–µ
—É–∫–∞–∑—ã–≤–∞—é—Ç –±—Ä–∞–∑—É–µ—Ä–∞–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏—Å—Ç–æ–Ω–∏—á–Ω–∏–∫–∏, –æ—Ç–∫—É–¥–∞ –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã (—Å–∫—Ä–∏–ø—Ç—ã, —Å—Ç–∏–ª–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è):
    ```java
    contentSecurityPolicy(
      csp -> csp.policyDirectives("script-src 'self'; " +
                                            "style-src 'self'; " +
                                            "img-src: 'self'")
    )
    ```

#### –ö–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å—Ç–∞—Ä—Ç–µ—Ä–∞ spring-boot-starter-security:3.5.5 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º JWT. –ö–ª—é—á –ø–æ–¥–ø–∏—Å–∏ –∏ 
–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏, –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–µ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É–≥—Ä–∞—Ü–∏—é application.yml:
```yml
spring:
  application:
    name: sec-lab1
  datasource:
    url: jdbc:postgresql://localhost:5432/sec_lab1
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver
  flyway:
    schemas: public
    default-schema: public
security:
  token:
    signing-key: ${TOKEN-SIGNING-KEY}
    ttl-seconds: 600
```
–ü–æ–¥–ø–∏—Å—å –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º HS256. –ü–∞—Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ö—ç—à–∏—Ä—É—é—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º bcrypt.

–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã /auth/sign-up /auth/sign-in. –î–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ jwt
–∏—Å–ø–æ–ª—å—É–µ—Ç—Å—è middleware JwtAuthenticationFilter, –≥–¥–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –≥–æ–¥–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SpringSecurityContext-–∞

–í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ JWT –≤–∞–ª–∏–¥–µ–Ω, –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–∞–ª–µ–µ, –∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 403.

### –°–∫—Ä–∏–Ω—à–æ—Ç—ã CI/CD

<img width="1468" height="780" alt="image" src="https://github.com/user-attachments/assets/83fcfe97-24a4-48f3-b52b-04c046bdbd85" />

<img width="1006" height="637" alt="image" src="https://github.com/user-attachments/assets/7c7de1f8-7c12-463c-ac75-ad8bd52be394" />

<img width="1468" height="790" alt="image" src="https://github.com/user-attachments/assets/64a178d2-db55-41ea-9596-651df3e9ec5f" />




